<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>海大教室借用平台</title>
  <link rel="stylesheet" href="CSS/Home.css">
</head>

<body>

  <div class="container">
    <img src="classroom cover.jpg">

    <div class="overlay">

      <div class="top-column">
        <h1>海大教室借用平台</h1>
        <button id="login-signup">登入/註冊</button>
      </div>

      <div class="function">


        <div class="box">
          <div class="date">
            <label for="datePicker">選擇日期：</label>
            <input type="date" id="datePicker" name="datePicker" onchange="updateLabel()">
            <span>
              <!-- <form action="AllClassRoom.html" method="POST">
                            <img src="queryIcon.png">
                            <input type="submit" value="提交">
                        </form> -->
              <a href="index.html" target="_self" class="verification-button"><img src="queryIcon.png"></a>
            </span>

          </div>

        </div>
      </div>

    </div>


  </div>

  <script>
    const now = new Date();

    const datePicker = document.getElementById("datePicker");

    datePicker.value = dateToString(now);
    datePicker.min = dateToString(now);
    datePicker.max = add30(now);

    function dateToString(date) {
      let temp = new Date(date);
      //格式化日，如果小於9，前面補0
      let day = ("0" + temp.getDate()).slice(-2);
      //格式化月，如果小於9，前面補0
      let month = ("0" + (temp.getMonth() + 1)).slice(-2);
      //拼裝完整日期格式
      let result = temp.getFullYear()+"-"+(month)+"-"+(day);
      return result;
    }

    function add30(date) {
      let resultDate = new Date(date);
      resultDate.setDate(resultDate.getDate() + 30);
      return dateToString(resultDate);
    }

    //已登入
    if(localStorage.getItem("username") !== null) {
      document.getElementById("login-signup").id = "login-signup-completed";
      document.getElementById("login-signup-completed").innerHTML = "<img src='usericon.png' class='usericon'>"+localStorage.getItem("username");
      document.getElementById("login-signup-completed").addEventListener("click", function(event) {
        localStorage.removeItem("username");
        document.getElementById("login-signup-completed").id = "login-signup";
        window.location.reload();
      }, false);
    }
    else {//未登入
      document.getElementById("login-signup").addEventListener("click", function (event) {
        window.location.href = "選擇登入身分.html";
      }, false);
    }

    function updateLabel() {
      const selectedDate = datePicker.value;
      // const label = document.querySelector('label[for="datePicker"]');
      // label.textContent = "選擇日期：" + selectedDate;
      // 存儲選定的日期到本地存儲
      localStorage.setItem("selectedDate", selectedDate);
      // 導航到 "next.html"
      // window.location.href = "next.html";

    }
  </script>
</body>

</html>